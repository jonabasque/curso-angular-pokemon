<!DOCTYPE html>
<html ng-app="pokedex">
    <head>
        <meta  charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Pokedex</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="css/main.css">

    </head>
    <body>
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container-fluid">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                  </button>
                  <a class="navbar-brand" href="#">
                    <img src="img/logo.png">
                    Pokédex
                  </a>
                </div>
            </div>
        </nav>
        <div class="container">
            <!-- pokemon -->
            <div ng-controller="PokemonController as pkmCtrl">
                <div class="page-header">
                    <h1>
                        {{pkmCtrl.pokemon.name}} <small>{{pkmCtrl.pokemon.species}} </small>
                        <span class="label label-primary pull-right">#{{pkmCtrl.pokemon.id}}</span>
                    </h1>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <img class="avatar center-block" ng-src="img/pokemons/{{pkmCtrl.pokemon.name | lowercase}}.jpg">
                    </div>

                    <!-- Agregamos el controlador de Tabs para poder usar la lógica de nuestro controlador dentro de este elemento-->
                    <div class="col-md-6" ng-controller="TabsController as tabs">
                        <ul class="nav nav-tabs nav-justified">

                            <!-- Ahora con el controlador tenemos que acceder a la variable mediante el alias del mismo -->
                            <li ng-class="active : tabs.tab === 1" ng-click="tabs.selectTab(1)"><a href="#">Pokedex</a></li>
                            <!-- En las directivas ng-click ahora cambiamos a usar una funcion que seleccione el tab que le indiquemos. -->
                            <li ng-class="active : tabs.tab === 2" ng-click="tabs.selectTab(2)"><a href="#">Estadisticas</a></li>
                            <li ng-class="active : tabs.tab === 3" ng-click="tabs.selectTab(3)"><a href="#">Evolución</a></li>
                        </ul>
                    <!-- Ahora con el controlador ya no tenemos que inicializar el valor a 1 por que ya lo estamos haciendo en el controlador.-->
                    <div class="tab-content">

                        <!-- Usamos la directiva ng-show por si sola (sin depender de otra directiva como hacemos en las flechas de la evolución) para mostra o no el contenido del tab cuando el valor sea el suyo, que lo cambiaremos cuando se pulse ene el-->
                    <div ng-show="tabs.tab === 1"> <!--Pokedex-->
                      <ul class="list-group">
                        <li class="list-group-item">
                          <strong>Tipo: </strong>
                          <span class="pull-right">
                              <!-- La directiva ng-repeat nos repetirá el span por cada uno de los elementos del array recorrido -->
                              <span ng-repeat="type in pkmCtrl.pokemon.type" class="label type-{{type | lowercase }}"> <!-- De esta manera usaremos una clase u otra dependiendo de el tipo de pokemon-->
                                  <!--Este tipo es cada uno de los elementos del array iterado-->
                                  {{type}}
                              </span>
                          </span>
                        </li>
                        <li class="list-group-item">
                          <strong>Altura:</strong>
                          <span class="pull-right">{{pkmCtrl.pokemon.height}}</span>
                        </li>
                        <li class="list-group-item">
                          <strong>Peso: </strong>
                          <span class="pull-right">{{pkmCtrl.pokemon.weight}}</span>
                        </li>
                        <li class="list-group-item">
                            <strong>Habilidades: </strong>

                            <!-- Hacemos lo mismo que con los tipos pero está vez repetimos los li y solo tenemos que escribir uno -->
                            <ul>
                                <li ng-repeat="habilidad in pkmCtrl.pokemon.abilities">
                                <!-- De esta manera no tenemos que agregar más habilidades aquí si no en el controlador o vendrán desde una API -->
                                {{habilidad}}
                            </ul>
                        </li>
                      </ul>
                    </div>

                    <!-- Hacemos lo mismo que con el tab de caracteristicas-->
                    <div ng-show="tabs.tab === 2"> <!-- Stadisticas -->
                      <ul class="list-group">
                        <li class="list-group-item">
                          <strong>HP</strong>
                          <span class="badge">{{pkmCtrl.pokemon.stats.hp}}</span>
                        </li>
                        <li class="list-group-item">
                          <strong>Ataque</strong>
                          <span class="badge">{{pkmCtrl.pokemon.stats.attack}}</span>
                        </li>
                        <li class="list-group-item">
                          <strong>Defensa</strong>
                          <span class="badge">{{pkmCtrl.pokemon.stats.defense}}</span>
                        </li>
                        <li class="list-group-item">
                          <strong>Ataque Especial</strong>
                          <span class="badge">{{pkmCtrl.pokemon.stats['sp.atk']}}</span>
                        </li>
                        <li class="list-group-item">
                          <strong>Defensa Especial</strong>
                          <span class="badge">{{pkmCtrl.pokemon.stats['sp.def']}}</span>
                        </li>
                        <li class="list-group-item">
                          <strong>Velocidad</strong>
                          <span class="badge">{{pkmCtrl.pokemon.stats.speed}}</span>
                        </li>
                        <li class="list-group-item">
                          <strong>Total</strong>
                          <span class="badge">{{pkmCtrl.pokemon.stats.total}}</span>
                        </li>
                      </ul>
                    </div>

                    <!-- Y hacemos lo mismo que con caracteristicas y estadisticas -->
                    <div ng-show="tabs.tab === 3"> <!-- Evolution -->
                        <!--Repetimos este div tantas veces como elementos tengamos en el array evolution y así dibujamos su evolución, tal y comom hemos hecho en los stributos type y abilities de las caracteristicas del pokemon -->
                        <div class="text-center" ng-repeat="pokemon in pkmCtrl.pokemon.evolution">
                            <a href="#">
                              <img src="img/pokemons/{{pokemon | lowercase}}.jpg" width="160">
                              <p>
                                <strong>{{pokemon}}</strong>
                              </p>
                            </a>
                            <!-- como no queremos la flecha hacia abajo en el último pokemon, usamos la directiva ng-hide que nos esconderá el elemento que le indiquemos de la iteracción con ng-repeat -->
                            <span ng-hide="$last" class="glyphicon glyphicon-arrow-down"></span>
                        </div>
                    </div>
                    </div> <!--/tab-content-->
                </div><!--/row-->

                <!-- comments -->
                <!-- Agregamos el controlador a la seccion de comentarios-->
                <section ng-controller="ComentsController as cmtsCtrl">
                    <!-- Cuando hagamos click en el boton mostraremos el div de comentarios-->
                    <button ng-click="cmtsCtrl.toogle()" ng-hide="cmtsCtrl.show" class="btn btn-primary">Mostrar comentarios <span class="badge">{{cmtsCtrl.comments.length}}</span></button>
                    <!--Bindeamos o asociamos el panel de comentarios a la propiedad show del controlador ComentsController -->
                    <div ng-show="cmtsCtrl.show === true" class="panel panel-primary">
                        <div class="panel-heading">
                            <h1 class="panel-title"> Comentarios
                                <!-- Igual que en el button de ver comentarios añadimos la llamada al método toogle() para que nos cambie el estado. -->
                                <button ng-click="cmtsCtrl.toogle()" class="close pull-right">&times;</button>
                            </h1>
                        </div><!-- /panel-heading-->
                        <div class="panel-body">
                            <form class="form-horizontal" role="form">
                            <div class="form-group">
                                <div class="col-sm-6">
                                <textarea placeholder="Comenta algo acerca de  {{pkmCtrl.pokemon.name}}" class="form-control"></textarea>
                            </div>
                            <div class="col-sm-4">
                                <input type="email" placeholder="Inserta tu email" class="form-control">
                                <label>
                                <input id="anonymous" type="checkbox">
                                Anónimo
                                </label>
                            </div>
                            <div class="col-sm-2">
                                <button class="btn btn-lg">Comentario</button>
                            </div>
                          </div>
                        </form>
                        <blockquote>
                            <p>OMG Bulbasaur is AMAZING!!!</p>
                            <footer>
                            Por y <a href="mailto:pepe@pepe.com">pepe@pepe.com</a> on <span>Sep 12, 2014, 11:00:00 PM</span>
                            </footer>
                        </blockquote>
                        <blockquote>
                            <p>Nah, I hate it -_-</p>
                            <footer>
                            Por <em>Anonymous</em> on <span>Sep 12, 2014, 11:00:00 PM</span>
                            </footer>
                        </blockquote>
                    </div><!-- /panel-body-->
                  </div> <!-- /panel-primary-->
                </section><!-- /comments -->
            </div> <!-- /pokemon -->
        </div> <!--/container-->
        <script src="js/lib/angular.min.js"></script>
        <script src="js/app.js"></script>
    </body>
<html>
